<!-- Project name: Mapping Justice -->
<!-- Description: For our ACCR Collaborative Project we have created an interactive map of PA. The map is color coded by cases + death sentences and population. 
The user can hover over a county to view its statistics. Additionally, several counties can be clicked to generate charts-->
<!-- Filename: index.html.erb -->
<!-- Description: The file generates the view for the upload map data functionality. -->
<!-- Last modified on: 4/24/2022 -->

<div class="container" style= "padding bottom: 10px !important">
<br/>

<!-- Headers and directions -->
<h1 class = "text-center">County Map Data</h1>
<hr>
<% if can?(:access, :rails_admin) %>
  <h4 class="text-center">Please fill out information below in order to update the map. </h4> 
  <br>
  <h4 class="text-center">Upload your spreadsheet with new data here in order to update the map. </h4> 

  <!-- To download copy of current data -->
  <h5 class="text-center">Click <a href='downloadcsv'> here</a> to download the current data spreadsheet.</h5>
  <br/>
  <div class="text-center">
  <!-- Rendering form partial for file upload -->
  <%= render 'form' %>
  </div>
  </div>
<% end %>
<!-- To display flash notice and error messages -->
<% flash.each do |type, msg| %>
    <div style="font-weight:bold;text-align:center">
      <%= msg %>
    </div>
<% end %>
<br>

<br>

  <h5 class="text-center">Search Counties</h5>
  <section class="search-form">
    <%= form_for :upload, method: :get do |f| %>
      <div class="input-group input-group-lg">
        <%= label_tag :countyName, nil, class: "sr-only" %>
        <%= text_field_tag :countyName, nil,
          placeholder: "County name",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :minPop, nil, class: "sr-only" %>
        <%= text_field_tag :minPop, nil,
          placeholder: "Min Population",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :maxPop, nil, class: "sr-only" %>
        <%= text_field_tag :maxPop, nil,
          placeholder: "Max Population",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :totalPend, nil, class: "sr-only" %>
        <%= text_field_tag :totalPend, nil,
          placeholder: "Total Pending Cases",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :bPend, nil, class: "sr-only" %>
        <%= text_field_tag :bPend, nil,
          placeholder: "Pending Cases(Black)",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :wPend, nil, class: "sr-only" %>
        <%= text_field_tag :wPend, nil,
          placeholder: "Pending Cases(White)",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :oPend, nil, class: "sr-only" %>
        <%= text_field_tag :oPend, nil,
          placeholder: "Pending Cases(Other)",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :totalCases, nil, class: "sr-only" %>
        <%= text_field_tag :totalCases, nil,
          placeholder: "Total Current Cases",
          class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :bCase, nil, class: "sr-only" %>
        <%= text_field_tag :bCase, nil,
          placeholder: "Current Cases(Black)",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :wCase, nil, class: "sr-only" %>
        <%= text_field_tag :wCase, nil,
          placeholder: "Current Cases(White)",
            class: "form-control input-lg" %>
      </div>
      <br>
      <div class="input-group input-group-lg">
        <%= label_tag :oCase, nil, class: "sr-only" %>
        <%= text_field_tag :oCase, nil,
          placeholder: "Current Cases(Other)",
            class: "form-control input-lg" %>
      </div>

      <div class="input-group input-group-lg">
        <%= submit_tag "Find Counties", class: "btn btn-primary btn-lg" %>
      </div>

    <% end %>
  </section>

<!-- Displays the Pro Bono Hours in a table -->
  <table class="table table-hover table-striped">
    <thead>
      <tr>
        <th scope="col">County</th>
        <th style="text-align: center" scope="col">Population</th>
        <th style="text-align: center" scope="col">Total Number of Pending Cases</th>
        <th style="text-align: center" scope="col">Pending Cases: Black/White/Other</th>        
        <th style="text-align: center" scope="col">Total Number of Current Death Sentence Cases</th>
        <th style="text-align: center" scope="col">Current Death Sentence Cases Black/White/Other</th>
        <!-- <th scope="col">Description</th> -->
        <% if can?(:access, :rails_admin) %>
        <th scope="col">Actions</th>
        <% end %>
      </tr>
    </thead>
    <% @counties.each do |county| %>
    <tr>
      <td scope="col"><%= county.name%></td>
      <td style="text-align: center" scope="col"><%= county.population%></td>
      <td style="text-align: center" scope="col"><%= county.num_cur_cases%></td>
      <td style="text-align: center" scope="col"><%= county.num_cur_cases_b%> / <%=county.num_cur_cases_w%> / <%=county.num_cur_cases_o%></td>      
      <td style="text-align: center" scope="col"><%= county.num_dr%></td>
      <td style="text-align: center" scope="col"><%= county.num_dr_b%> / <%=county.num_dr_w%> / <%=county.num_dr_o%></td>
      <% if can?(:access, :rails_admin) %>
      <td>
        <%= link_to 'Edit ', upload_edit_path(county)%>
      </td>
      <% end %>
    </tr>
  <% end %>
  </table>
<br><br>

<div class="text-left">
  <%= button_tag "Reset", type: "button", class: "btn btn-secondary btn-lg", onclick: "window.location.href = '#{upload_index_path}'" %>
</div>

<!-- Div for footer -->
<div id="footer">
    <hr>
    <a>Â© 2022 Copyright: Mapping Justice</a>
</div>